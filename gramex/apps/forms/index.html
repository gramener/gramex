<!doctype html>
<html lang="en">

{% set base = '.' %}
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Form Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="{{ base }}/node_modules/dragula/dist/dragula.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ base }}/style.css">
</head>

<body>
  {% include template-navbar.html %}
  {% import os %}
  {% from form_builder import FOLDER %}
  <div class="container-fluid py-4">
    <h1 class="text-center text-muted">Creating a new form</h1>
    <div class="form-details step-1 my-3 py-3">
      <h3>Step 1 - Form details</h3>
      <div class="divider"></div>
      <form class="needs-validation" novalidate>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="form-name">Form name</label>
            <input type="text"
              class="form-control" name="form-name" id="form-name" aria-describedby="form-name-helpId" placeholder="" pattern=".{5,}" value="form name..." minlength="5" required="required">
            <small class="text-muted">At least five characters are required</small>
          </div>
          <div class="col-md-6 mb-3">
            <label for="form-description">Description</label>
            <textarea class="form-control" name="form-description" id="form-description" rows="2" cols="5" minlength="5" required="required"></textarea>
            <small class="text-muted">At least five characters are required</small>
          </div>
        </div>
      </form>
    </div>
    <h3>Step 2 - Configure form</h3>
    <div class="divider"></div>

    <div class="card-deck step-2">
      <div class="card border-0">
        <div class="card-header bg-white d-flex justify-content-between">
          <h5 class="card-title my-0">Select fields</h5>
        </div><!-- .card-header -->
        <div class="card-body h-100">
          {% set snippets_path = os.path.join(FOLDER, 'snippets.html') %}
          {% module Template(snippets_path, FOLDER=FOLDER) %}
        </div><!-- .card-body -->
      </div><!-- .card -->
      <div class="card border-0">
        <div class="card-header bg-white d-flex justify-content-between">
          <h5 class="card-title my-0">Drag here</h5>
        </div><!-- .card-header -->
        <div class="card-body">
          <div id="user-form">
            <form class="user-form h-100 w-100"></form>
          </div>
          <a class="btn btn-link d-none" title="Edit code">
            <i class="fa fa-code"></i>
          </a>
          <div class="divider"></div>
          <input type="text" class="py-2 form-control d-none" id="form-name" placeholder="Name your form" required>
          <button class="btn btn-primary mt-2 d-none" id="publish-form">Publish</button>
          <div class="py-2 my-2">
            <p class="post-publish d-none">
              <span class="form-link"></span>
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-up-right-square-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.879 10.828a.5.5 0 1 1-.707-.707l4.096-4.096H6.5a.5.5 0 0 1 0-1h3.975a.5.5 0 0 1 .5.5V9.5a.5.5 0 0 1-1 0V6.732l-4.096 4.096z"/>
              </svg>
            </p>
          </div>
        </div><!-- .card-body -->
      </div><!-- .card -->
      <div class="card border-0">
        <div class="card-header bg-white d-flex justify-content-between">
          <h5 class="card-title my-0">Element Properties</h5>
        </div><!-- .card-header -->
        <div class="card-body">
          <div id="element-properties"></div>
          <div id="editor-html"></div>
          <button class="btn btn-primary update-form d-none my-2">Update form</button>
        </div><!-- .card-body -->
      </div><!-- .card -->
    </div><!-- .card-deck -->
  </div><!-- .container-fluid -->
  <div class="popover-container"></div>
  <script type="text/html" data-target="#element-properties" class="popover-template" src="popover-form.html"></script>
  <script type="text/html" class="input-template" src="snippets/input/text.html"></script>

  <script src="{{ base }}/ui/jquery/dist/jquery.min.js"></script>
  <script src="{{ base }}/ui/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{{ base }}/ui/lodash/lodash.min.js"></script>
  <script src="{{ base }}/ui/g1/dist/g1.min.js"></script>
  <script src="{{ base }}/node_modules/dragula/dist/dragula.min.js"></script>
  <script src="{{ base }}/node_modules/monaco-editor/min/vs/loader.js"></script>
  <script>
    /* exported user, user_name */
    let user = '{% raw handler.current_user.get("id") if handler.current_user else '' %}'
    require.config({ paths: { 'vs': '{{ base }}/node_modules/monaco-editor/min/vs' }})
    var editor
    require(['vs/editor/editor.main'], function() {
      editor = monaco.editor.create(document.getElementById('editor-html'), {
        language: 'html'
      })
    })
  </script>
  <script src="{{ base }}/js/script.js"></script>
  <!-- Commonly used libraries:
  <script src="ui/d3v5/dist/d3.min.js"></script>
  <script src="ui/morphdom/dist/morphdom-umd.min.js"></script>
  <script src="ui/moment/min/moment-with-locales.min.js"></script>
  <script src="ui/daterangepicker/daterangepicker.js"></script>
  <script src="ui/leaflet/dist/leaflet.js"></script>
  <script src="ui/topojson/dist/topojson.min.js"></script>
  -->
</body>
</html>
